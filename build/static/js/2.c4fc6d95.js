webpackJsonp([2],{237:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),i=n.n(o),c=n(97),l=n(99),u=n(250),m=n(246),f=n.n(m),h=n(247),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={id:e.match.params.id,items:[],show:!1,num:240,fade:!1,text:"",comments:[],comment:[],hidden:!1,number:0,lineHeight:!1,message:"",danger:!1,toast:!1},n}return s(t,e),p(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"moreComment page"},i.a.createElement(c.a,null),i.a.createElement("div",{className:f()({toa:!this.state.toast,toastBox:this.state.toast})},i.a.createElement(h.a,{mes:this.state.message,danger:this.state.danger})),i.a.createElement(u.a,{data:this.state.items}),i.a.createElement("div",{className:f()({none:this.state.hidden,block:!this.state.hidden,answer:!0})},i.a.createElement("h6",null,"\u56de\u5e94",this.state.number),i.a.createElement(u.a,{data:this.state.comments})),i.a.createElement(l.a,null),i.a.createElement("div",{className:"response",onClick:this.addRes.bind(this)},"\u6dfb\u52a0\u56de\u5e94"),i.a.createElement("div",{className:f()({bg:!0,none:!this.state.show,fade:this.state.show}),onClick:this.hidden.bind(this)}),i.a.createElement("div",{className:f()({addRes:!0,none:!this.state.show,downUp:this.state.show,upDown:this.state.fade})},i.a.createElement("div",{className:"text"},i.a.createElement("textarea",{placeholder:"\u6dfb\u52a0\u56de\u5e94",onChange:this.addText.bind(this),value:this.state.text,ref:"textarea"})),i.a.createElement("div",{onClick:this.adding.bind(this),className:f()({lineHeight:this.state.lineHeight,add:!0})},"\u52a0\u4e0a\u53bb",i.a.createElement("span",null,this.state.num))))}},{key:"componentWillMount",value:function(){var e=this,t=[];console.log(this.state.id),t=t.concat(JSON.parse(localStorage.getItem("broadcast"+this.state.id)));var n=JSON.parse(localStorage.getItem("comment"+this.state.id))||[];this.setState({items:t,comments:n},function(){0!=e.state.comments.length?e.setState({hidden:!1,number:e.state.comments.length}):e.setState({hidden:!0,number:0})})}},{key:"addRes",value:function(){this.setState({show:!0,fade:!1})}},{key:"hidden",value:function(){var e=this;this.setState({fade:!0}),setTimeout(function(){e.setState({show:!1})},400)}},{key:"addText",value:function(e){var t=e.currentTarget.value.length;if(t>0?this.setState({lineHeight:!0}):this.state({lineHeight:!1}),t>=240){var n=e.currentTarget.value.substr(0,240);this.setState({num:0,text:n})}else this.setState({num:240-e.currentTarget.value.length,text:e.currentTarget.value})}},{key:"adding",value:function(){var e=this;if(0==this.refs.textarea.value.length)return console.log("\u7a7a\u7684"),void this.setState({danger:!0,message:"\u8be5\u8bc4\u8bba\u4e3a\u7a7a",toast:!0},function(){setTimeout(function(){e.setState({toast:!1})},5e3)});var t=JSON.parse(localStorage.getItem("comment"+this.state.id))||[],n=(new Date).getTime();t=t.concat({text:this.state.text,time:n,user:"acechl"}),localStorage.setItem("comment"+this.state.id,JSON.stringify(t));var a=this.state.comments;a=a.concat({text:this.state.text,time:n,user:"acechl"}),this.setState({comments:a,message:"\u6dfb\u52a0\u6210\u529f",toast:!0,danger:!1},function(){setTimeout(function(){e.hidden(),e.setState({toast:!1,lineHeight:!1}),e.setState({text:""})},2e3)})}}]),t}(i.a.Component);t.default=d},246:function(e,t,n){var a,r;!function(){"use strict";function n(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var r=typeof a;if("string"===r||"number"===r)e.push(a);else if(Array.isArray(a))e.push(n.apply(null,a));else if("object"===r)for(var o in a)s.call(a,o)&&a[o]&&e.push(o)}}return e.join(" ")}var s={}.hasOwnProperty;"undefined"!==typeof e&&e.exports?e.exports=n:(a=[],void 0!==(r=function(){return n}.apply(t,a))&&(e.exports=r))}()},247:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=n(5),i=n.n(o),c=n(246),l=n.n(c),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),m=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return s(t,e),u(t,[{key:"render",value:function(){return i.a.createElement("div",{className:l()({toast:!0,toastDanger:this.props.danger,toastOk:!this.props.danger})},this.props.mes)}}]),t}(o.Component);t.a=m},250:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=n(5),i=n.n(o),c=n(27),l=n(96),u=(n.n(l),n(246)),m=n.n(u),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),h=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={items:[],user:""},n}return s(t,e),f(t,[{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"comment"},i.a.createElement("ul",null,this.props.data.map(function(t){return i.a.createElement("li",{key:t.id},i.a.createElement(c.d,{to:"/moreComment/"+t.id},i.a.createElement("span",{className:"pic"}),i.a.createElement("div",{className:"contents"},i.a.createElement("p",null,e.state.user,i.a.createElement("span",null,"\u8bf4")),i.a.createElement("p",{className:"time"},e.formatTime(t.time)),i.a.createElement("p",{className:"content"},t.text),i.a.createElement("div",{className:"svg clearfix"},i.a.createElement("div",{className:"like svgs fl",onClick:e.liking.bind(e,t.id,t.like)},t.like),i.a.createElement("div",{className:"com svgs fl"},t.comment),i.a.createElement("div",{className:"transport svgs fl"},t.transport),i.a.createElement("div",{className:"more fr",onClick:e.getMore.bind(e,t.id)},"...",i.a.createElement("div",{ref:"more"+t.id,className:m()({none:!t.display,block:t.display,delete:!0,clearfix:!0})},i.a.createElement("span",{className:"fl",onClick:e.delete.bind(e,t.id)},"\u5220\u9664"),i.a.createElement("span",{className:"fr"},"\u4e3e\u62a5")))))))})))}},{key:"componentWillMount",value:function(){this.setState({user:localStorage.getItem("user")})}},{key:"componentDidMount",value:function(){}},{key:"formatTime",value:function(e){function t(e){return e<10?"0"+e:e}var n=new Date(e),a=n.getFullYear(),r=n.getMonth()+1,s=n.getDate(),o=n.getHours(),i=n.getMinutes(),c=n.getSeconds();return a+"-"+t(r)+"-"+t(s)+" "+t(o)+":"+t(i)+":"+t(c)}},{key:"getMore",value:function(e,t){t.preventDefault();var n=this.state.items;n.map(function(t){t.id==e&&(t.display=!t.display)}),this.setState({items:n})}},{key:"liking",value:function(e,t,n){n.preventDefault();var a=this.state.items;a.map(function(n){n.id==e&&(n.like=t+1,localStorage.setItem("broadcast"+e,JSON.stringify(n)))}),this.setState({items:a})}},{key:"delete",value:function(e,t){t.preventDefault(),localStorage.removeItem("broadcast"+e);var n=this.state.items;n.map(function(t,a){t.id==e&&n.splice(a,1)})}}]),t}(i.a.Component);t.a=h}});
//# sourceMappingURL=2.c4fc6d95.js.map